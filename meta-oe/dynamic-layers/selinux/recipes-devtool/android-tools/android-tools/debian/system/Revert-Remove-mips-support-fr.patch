From: Roger Shimizu <rosh@debian.org>
Date: Sun, 20 Nov 2022 12:41:24 -0800
Subject: Revert "Remove mips support from register getting functions"

This partly reverts commit eead878fde3b9df5b5d819b955f7e5da2c3b1589.
---
 system/unwinding/libunwindstack/Regs.cpp | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/system/unwinding/libunwindstack/Regs.cpp b/system/unwinding/libunwindstack/Regs.cpp
index 4d5a878..b762e1a 100644
--- a/system/unwinding/libunwindstack/Regs.cpp
+++ b/system/unwinding/libunwindstack/Regs.cpp
@@ -26,10 +26,14 @@
 #include <unwindstack/Regs.h>
 #include <unwindstack/RegsArm.h>
 #include <unwindstack/RegsArm64.h>
+#include <unwindstack/RegsMips.h>
+#include <unwindstack/RegsMips64.h>
 #include <unwindstack/RegsX86.h>
 #include <unwindstack/RegsX86_64.h>
 #include <unwindstack/UserArm.h>
 #include <unwindstack/UserArm64.h>
+#include <unwindstack/UserMips.h>
+#include <unwindstack/UserMips64.h>
 #include <unwindstack/UserX86.h>
 #include <unwindstack/UserX86_64.h>
 
@@ -64,6 +68,10 @@ Regs* Regs::RemoteGet(pid_t pid) {
     return RegsArm::Read(buffer.data());
   case sizeof(arm64_user_regs):
     return RegsArm64::Read(buffer.data());
+  case sizeof(mips_user_regs):
+    return RegsMips::Read(buffer.data());
+  case sizeof(mips64_user_regs):
+    return RegsMips64::Read(buffer.data());
   }
   return nullptr;
 }
@@ -89,6 +97,10 @@ ArchEnum Regs::RemoteGetArch(pid_t pid) {
       return ARCH_ARM;
     case sizeof(arm64_user_regs):
       return ARCH_ARM64;
+    case sizeof(mips_user_regs):
+      return ARCH_MIPS;
+    case sizeof(mips64_user_regs):
+      return ARCH_MIPS64;
   }
   return ARCH_UNKNOWN;
 }
@@ -103,6 +115,11 @@ Regs* Regs::CreateFromUcontext(ArchEnum arch, void* ucontext) {
       return RegsArm::CreateFromUcontext(ucontext);
     case ARCH_ARM64:
       return RegsArm64::CreateFromUcontext(ucontext);
+    case ARCH_MIPS:
+      return RegsMips::CreateFromUcontext(ucontext);
+    case ARCH_MIPS64:
+      return RegsMips64::CreateFromUcontext(ucontext);
+    case ARCH_UNKNOWN:
     default:
       return nullptr;
   }
